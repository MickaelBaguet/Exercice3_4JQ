<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <link rel="stylesheet" href="assets/css/style.css">
  <title>Exercice 3</title>
</head>
<body>
  <div class="container-fluid text-center">
    <div class="jumbotron jumbotron-fluid">
      <div class="container">
        <span class="sommaire"><a href="../index.html">Sommaire</a></span>
        <h1 class="display-3">Exercice 3 - JQuery</h1>
        <h3>Partie 4</h3>
        <p class="lead">Vérification de formulaire</p>
      </div>
    </div>
    <!-- novalidate permet au formulaire de ne rien renvoyer à la validation -->
    <form novalidate id="formContact">
      <!-- Ajout de l'attribut required (booléen) qui indique les éléments obligatoires  -->
      <!-- pour remplir correctement un formulaire -->
      <p>Nom : <input type="text" name="nom" id="nom" required></p>
      <p>Prénom : <input type="text" name="prenom" id="prenom" required></p>
      <p>Mail : <input type="email" name="mail" id="mail" placeholder="exemple@domaine.com" required></p>
      <p>Téléphone : <input type="tel" name="tel" id="tel" maxlength="10" placeholder="0312345678" required></p>
      <input type="submit" id="valid">
    </form>
  </div>

  <script src="assets\js\jquery-3.3.1.min.js"></script>
  <script>
    // Utilisation de regexp pour tester la validité des champs
    var nameRegex = /^[A-Z]{1}[a-z]+([-]?[A-Z]{1}[a-z]*)$/;
    // var nameRegex = /[a-zA-ZàçéèîïÀÇÉÈÎÏ '-]+$/;
    var mailValid = /^[a-zA-Z][a-zA-Z0-9]+([_\.-]?[a-zA-Z0-9]+)@[a-zA-Z]+\.[a-zA-Z]{2,5}$/;
    var phoneRegex = /^0[67][0-9]{8}$/;

    $(document).ready(function (){

      $("#formContact").submit(function() {

        // $("#formContact").submit(function(e) {
        //   e.preventDefault();
        // });
        // var inputs = $('input');
        // // Nettoie le message d'erreur afin d'éviter un cumul
        // $('small').remove();
        // $.each(inputs, function(){
        //   // On récupère l'input
        //   let input = this;
        //   // Si l'input n'est pas valide au contrainte indiquée dans le HTML
        //   if (!input.validity.valid) {
        //     // Création d'une variable servant à afficher un message d'erreur
        //     var small = $('<small></small>');
        //     // On le met en rouge grâce à Bootstrap
        //     small.addClass('alert alert-danger');
        //     // On lui rajoute le texte de validation par défaut
        //     small.text(input.validationMessage);
        //     // On l'insert après l'input actif
        //     $(input).after(small);
        //   }
        // },false);

        var nom = $('#nom').val();
        var prenom = $('#prenom').val();
        var mail = $('#mail').val();
        var tel = $('#tel').val();

        event.preventDefault();
        // On vérifie si la valeur du champ respecte la regexp
        // .test(): vérifie s'il y a une correspondance entre un texte et une regexp, renvoi un booléen
        if (nameRegex.test(nom) == false) {
          // Si c'est faux on émet une alerte et on change la couleur des bordures
          alert ("Nom invalide !");
          $('#nom').css('border-color', 'red');
        } else {
          $('#nom').css('border-color', '');
        }
        // Si le prénom n'est pas valide
        if (nameRegex.test(prenom) == false) {
          alert ("Prénom invalide !");
          $('#prenom').css('border-color', 'red');
        } else {
          $('#prenom').css('border-color', '');
        }
        // Si le mail n'est pas valide
        if (mailValid.test(mail) == false) {
          alert ("Mail invalide !");
          $('#mail').css('border-color', 'red');
        } else {
          $('#mail').css('border-color', '');
        }
        // Si le numéro n'est pas un nombre ou qu'il ne fait pas 10 caractères
        if (phoneRegex.test(tel) == false) {
          alert ("Téléphone invalide !");
          $('#tel').css('border-color', 'red');
        } else {
          $('#tel').css('border-color', 'red');
        }
      });
    });
  </script>
</body>
</html>
